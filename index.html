<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Study Tracker - EMRS & KVS Exams</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #4fc3f7;
            --primary-dark: #03a9f4;
            --primary-light: #b3e5fc;
            --secondary: #ff9800;
            --accent: #e91e63;
            --text-dark: #37474f;
            --text-light: #78909c;
            --bg-light: #f5fdff;
            --white: #ffffff;
            --shadow: 0 4px 12px rgba(79, 195, 247, 0.2);
            --radius: 12px;
            --safe-area: env(safe-area-inset-top);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        html {
            height: 100%;
            scroll-behavior: smooth;
        }

        body {
            background: linear-gradient(135deg, #e3f2fd 0%, #f5fdff 100%);
            color: var(--text-dark);
            min-height: 100vh;
            padding: 15px;
            padding-top: max(15px, var(--safe-area));
            line-height: 1.5;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Mobile First Header */
        header {
            text-align: center;
            margin-bottom: 20px;
            padding: 15px;
            background: var(--white);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }

        .logo-inner {
            width: 45px;
            height: 45px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .logo-book {
            width: 22px;
            height: 30px;
            background: var(--primary-dark);
            border-radius: 3px;
            position: relative;
            transform: perspective(15px) rotateY(-5deg);
        }

        .logo-book::before {
            content: '';
            position: absolute;
            top: 4px;
            left: 3px;
            right: 3px;
            height: 6px;
            background: white;
            border-radius: 1px;
        }

        .logo-book::after {
            content: '';
            position: absolute;
            top: 14px;
            left: 3px;
            right: 3px;
            height: 6px;
            background: white;
            border-radius: 1px;
        }

        .logo-pages {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                to bottom,
                transparent,
                transparent 4px,
                rgba(255,255,255,0.3) 4px,
                rgba(255,255,255,0.3) 6px
            );
            border-radius: 3px;
        }

        .logo-glow {
            position: absolute;
            top: -8px;
            right: -8px;
            width: 16px;
            height: 16px;
            background: var(--secondary);
            border-radius: 50%;
            filter: blur(4px);
            opacity: 0.7;
        }

        .header-text {
            text-align: center;
        }

        h1 {
            color: var(--primary-dark);
            margin-bottom: 8px;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .subtitle {
            color: var(--text-light);
            font-size: 1rem;
        }

        .designer-badge {
            background: var(--accent);
            color: white;
            padding: 6px 12px;
            border-radius: 16px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        /* Mobile Optimized Exam Cards */
        .exam-cards {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .exam-card {
            background: var(--white);
            border-radius: var(--radius);
            padding: 20px;
            box-shadow: var(--shadow);
            transition: transform 0.3s ease;
        }

        .exam-card:active {
            transform: scale(0.98);
        }

        .exam-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .exam-title {
            font-size: 1.3rem;
            color: var(--primary-dark);
        }

        .days-left {
            background: var(--primary);
            color: white;
            padding: 4px 12px;
            border-radius: 16px;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .countdown {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .countdown-item {
            text-align: center;
            flex: 1;
        }

        .countdown-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary-dark);
        }

        .countdown-label {
            font-size: 0.75rem;
            color: var(--text-light);
        }

        .progress-section {
            margin: 20px 0;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .progress-bar {
            height: 8px;
            background: var(--primary-light);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--primary);
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        /* Mobile Timer Section */
        .timer-section {
            background: var(--white);
            border-radius: var(--radius);
            padding: 20px;
            box-shadow: var(--shadow);
            text-align: center;
            margin-bottom: 20px;
        }

        .section-title {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-bottom: 15px;
        }

        .section-title i {
            color: var(--primary);
            font-size: 1.3rem;
        }

        .section-title h2 {
            font-size: 1.4rem;
        }

        .subject-selector {
            margin-bottom: 15px;
        }

        select {
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid var(--primary-light);
            font-size: 1rem;
            color: var(--text-dark);
            background: var(--white);
            -webkit-appearance: none;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=US-ASCII,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 4 5'><path fill='%2337474f' d='M2 0L0 2h4zm0 5L0 3h4z'/></svg>");
            background-repeat: no-repeat;
            background-position: right 12px center;
            background-size: 12px;
        }

        .study-mode-selector {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }

        .mode-btn {
            padding: 14px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            background: var(--primary-light);
            color: var(--text-dark);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .mode-btn.active {
            background: var(--primary);
            color: white;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .mode-btn:active:not(.active) {
            background: var(--primary);
            color: white;
            transform: scale(0.95);
        }

        .timer-display {
            font-size: 3rem;
            font-weight: bold;
            color: var(--primary-dark);
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .timer-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }

        .btn {
            padding: 14px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }

        .btn:active {
            transform: scale(0.95);
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .btn-secondary {
            background: var(--secondary);
            color: white;
        }

        .btn-secondary:hover {
            background: #f57c00;
        }

        .btn-accent {
            background: var(--accent);
            color: white;
            grid-column: 1 / -1;
        }

        .btn-accent:hover {
            background: #c2185b;
        }

        .session-info {
            background: var(--primary-light);
            padding: 12px;
            border-radius: 8px;
            margin-top: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 0.9rem;
        }

        .session-info i {
            color: var(--primary-dark);
        }

        /* Mobile Subjects Grid */
        .subjects-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }

        .subject-card {
            background: var(--white);
            border-radius: var(--radius);
            padding: 15px;
            box-shadow: var(--shadow);
            transition: transform 0.3s ease;
        }

        .subject-card:active {
            transform: scale(0.98);
        }

        .subject-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
        }

        .subject-name {
            font-weight: bold;
            color: var(--primary-dark);
            font-size: 1.1rem;
        }

        .subject-hours {
            color: var(--text-light);
            font-size: 0.85rem;
        }

        .subject-progress {
            margin-bottom: 12px;
        }

        .progress-labels {
            display: flex;
            justify-content: space-between;
            font-size: 0.75rem;
            color: var(--text-light);
            margin-bottom: 4px;
        }

        .mode-progress {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 10px;
        }

        .mode-progress-item {
            text-align: center;
            padding: 8px;
            border-radius: 6px;
            background: var(--bg-light);
        }

        .mode-progress-item.reading {
            border-left: 4px solid #4fc3f7;
        }

        .mode-progress-item.revision {
            border-left: 4px solid #ff9800;
        }

        .mode-progress-item.practice {
            border-left: 4px solid #e91e63;
        }

        /* Mobile Notifications */
        .notification-section {
            background: var(--white);
            border-radius: var(--radius);
            padding: 20px;
            box-shadow: var(--shadow);
            margin-top: 20px;
        }

        .notification-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 15px;
        }

        .notification-header i {
            color: var(--secondary);
            font-size: 1.3rem;
        }

        .notification-header h2 {
            font-size: 1.4rem;
        }

        .notification-item {
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding: 15px 0;
            border-bottom: 1px solid var(--primary-light);
        }

        .notification-item:last-child {
            border-bottom: none;
        }

        .notification-content {
            flex: 1;
        }

        .notification-content h3 {
            font-size: 1.1rem;
            margin-bottom: 4px;
        }

        .notification-content p {
            font-size: 0.9rem;
            color: var(--text-light);
        }

        footer {
            text-align: center;
            margin-top: 30px;
            padding: 15px;
            color: var(--text-light);
            font-size: 0.85rem;
        }

        .designer {
            color: var(--primary-dark);
            font-weight: bold;
        }

        /* Desktop Styles */
        @media (min-width: 768px) {
            body {
                padding: 20px;
            }

            header {
                flex-direction: row;
                justify-content: space-between;
                text-align: left;
                padding: 20px;
            }

            .logo-container {
                flex: 1;
                justify-content: flex-start;
            }

            .header-text {
                text-align: left;
                flex: 2;
            }

            h1 {
                justify-content: flex-start;
                font-size: 2.2rem;
            }

            .subtitle {
                font-size: 1.1rem;
            }

            .designer-badge {
                position: static;
            }

            .exam-cards {
                grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                gap: 20px;
            }

            .study-mode-selector {
                grid-template-columns: repeat(3, 1fr);
            }

            .timer-controls {
                grid-template-columns: repeat(4, 1fr);
            }

            .btn-accent {
                grid-column: auto;
            }

            .subjects-grid {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            }

            .mode-progress {
                flex-direction: row;
            }

            .notification-item {
                flex-direction: row;
                align-items: center;
            }
        }

        @media (min-width: 1024px) {
            .timer-display {
                font-size: 4rem;
            }
            
            h1 {
                font-size: 2.5rem;
            }
        }

        /* Extra small devices */
        @media (max-width: 360px) {
            .timer-display {
                font-size: 2.5rem;
            }
            
            .countdown-value {
                font-size: 1.3rem;
            }
            
            .btn {
                padding: 12px;
                font-size: 0.9rem;
            }
        }

        /* Dark mode support */
        @media (prefers-color-scheme: dark) {
            :root {
                --text-dark: #e0e0e0;
                --text-light: #9e9e9e;
                --bg-light: #1a1a1a;
                --white: #2d2d2d;
                --shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            }

            body {
                background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            }

            select {
                background-color: #3d3d3d;
                color: #e0e0e0;
                border-color: #555;
            }
        }

        /* Swipe gestures for mobile */
        .swipe-hint {
            text-align: center;
            color: var(--text-light);
            font-size: 0.8rem;
            margin-top: 10px;
            display: none;
        }

        @media (max-width: 768px) {
            .swipe-hint {
                display: block;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo-container">
                <div class="logo">
                    <div class="logo-inner">
                        <div class="logo-book">
                            <div class="logo-pages"></div>
                        </div>
                    </div>
                    <div class="logo-glow"></div>
                </div>
                <div class="header-text">
                    <h1><i class="fas fa-graduation-cap"></i> Study Tracker</h1>
                    <p class="subtitle">EMRS & KVS Exam Preparation Assistant</p>
                </div>
            </div>
            <div class="designer-badge">Designed by Anurag</div>
        </header>

        <div class="exam-cards">
            <div class="exam-card">
                <div class="exam-header">
                    <h2 class="exam-title">EMRS Exam</h2>
                    <div class="days-left" id="emrs-days">Loading...</div>
                </div>
                <p>Date: December 13, 2025</p>
                <div class="countdown" id="emrs-countdown">
                    <div class="countdown-item">
                        <div class="countdown-value" id="emrs-days-value">--</div>
                        <div class="countdown-label">Days</div>
                    </div>
                    <div class="countdown-item">
                        <div class="countdown-value" id="emrs-hours-value">--</div>
                        <div class="countdown-label">Hours</div>
                    </div>
                    <div class="countdown-item">
                        <div class="countdown-value" id="emrs-minutes-value">--</div>
                        <div class="countdown-label">Minutes</div>
                    </div>
                    <div class="countdown-item">
                        <div class="countdown-value" id="emrs-seconds-value">--</div>
                        <div class="countdown-label">Seconds</div>
                    </div>
                </div>
                <div class="progress-section">
                    <div class="progress-header">
                        <span>Overall Progress</span>
                        <span id="emrs-progress-percent">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="emrs-progress-bar" style="width: 0%;"></div>
                    </div>
                </div>
            </div>

            <div class="exam-card">
                <div class="exam-header">
                    <h2 class="exam-title">KVS Exam</h2>
                    <div class="days-left" id="kvs-days">Loading...</div>
                </div>
                <p>Date: January 18, 2026</p>
                <div class="countdown" id="kvs-countdown">
                    <div class="countdown-item">
                        <div class="countdown-value" id="kvs-days-value">--</div>
                        <div class="countdown-label">Days</div>
                    </div>
                    <div class="countdown-item">
                        <div class="countdown-value" id="kvs-hours-value">--</div>
                        <div class="countdown-label">Hours</div>
                    </div>
                    <div class="countdown-item">
                        <div class="countdown-value" id="kvs-minutes-value">--</div>
                        <div class="countdown-label">Minutes</div>
                    </div>
                    <div class="countdown-item">
                        <div class="countdown-value" id="kvs-seconds-value">--</div>
                        <div class="countdown-label">Seconds</div>
                    </div>
                </div>
                <div class="progress-section">
                    <div class="progress-header">
                        <span>Overall Progress</span>
                        <span id="kvs-progress-percent">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="kvs-progress-bar" style="width: 0%;"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="timer-section">
            <div class="section-title">
                <i class="fas fa-clock"></i>
                <h2>Study Session Timer</h2>
            </div>
            
            <div class="subject-selector">
                <select id="subject-select">
                    <option value="">Select a subject to study...</option>
                    <optgroup label="EMRS Subjects">
                        <option value="teaching-aptitude">Teaching Aptitude</option>
                        <option value="ict">ICT</option>
                        <option value="reasoning">Reasoning</option>
                        <option value="nep">NEP</option>
                        <option value="case-study">Case Study</option>
                    </optgroup>
                    <optgroup label="KVS Subjects">
                        <option value="maths">Mathematics</option>
                        <option value="hindi">Hindi Language</option>
                        <option value="english">English Language</option>
                        <option value="gs">General Studies</option>
                    </optgroup>
                </select>
            </div>
            
            <div class="study-mode-selector">
                <button class="mode-btn" id="reading-btn">
                    <i class="fas fa-book"></i> Reading
                </button>
                <button class="mode-btn" id="revision-btn">
                    <i class="fas fa-sync-alt"></i> Revision
                </button>
                <button class="mode-btn" id="practice-btn">
                    <i class="fas fa-pencil-alt"></i> Practice
                </button>
            </div>
            
            <div class="timer-display" id="timer">00:00:00</div>
            
            <div class="timer-controls">
                <button class="btn btn-primary" id="start-btn">
                    <i class="fas fa-play"></i> Start
                </button>
                <button class="btn btn-primary" id="pause-btn" disabled>
                    <i class="fas fa-pause"></i> Pause
                </button>
                <button class="btn btn-secondary" id="reset-btn">
                    <i class="fas fa-redo"></i> Reset
                </button>
                <button class="btn btn-accent" id="save-btn">
                    <i class="fas fa-save"></i> Save
                </button>
            </div>
            
            <div class="session-info" id="session-info">
                <i class="fas fa-info-circle"></i>
                <span>Select a subject and study mode to begin</span>
            </div>
            
            <div class="swipe-hint">
                <i class="fas fa-hand-point-up"></i> Tap buttons to control timer
            </div>
        </div>

        <div class="subjects-grid" id="subjects-container">
            <!-- Subjects will be populated by JavaScript -->
        </div>

        <div class="notification-section">
            <div class="notification-header">
                <i class="fas fa-bell"></i>
                <h2>Daily Study Notifications</h2>
            </div>
            <div class="notification-item">
                <div class="notification-content">
                    <h3>Daily Practice Test Reminder</h3>
                    <p>Scheduled for 6:00 PM every day</p>
                </div>
                <div>
                    <button class="btn btn-primary" id="test-reminder-btn">Enable</button>
                </div>
            </div>
            <div class="notification-item">
                <div class="notification-content">
                    <h3>Study Session Reminders</h3>
                    <p>Get reminded to study at your preferred times</p>
                </div>
                <div>
                    <button class="btn btn-primary" id="study-reminder-btn">Configure</button>
                </div>
            </div>
            <div class="notification-item">
                <div class="notification-content">
                    <h3>Exam Countdown Alerts</h3>
                    <p>Weekly reminders about approaching exams</p>
                </div>
                <div>
                    <button class="btn btn-primary" id="countdown-alert-btn">Activate</button>
                </div>
            </div>
        </div>

        <footer>
            <p>Designed and Developed by <span class="designer">Anurag</span></p>
            <p>Study Tracker App &copy; 2024 - All Rights Reserved</p>
        </footer>
    </div>

    <script>
        // Exam data with updated dates
        const emrsDate = new Date('December 13, 2025 09:00:00').getTime();
        const kvsDate = new Date('January 18, 2026 09:00:00').getTime();

        // Subject data with zero initial progress
        const subjects = {
            // EMRS Subjects
            "teaching-aptitude": {
                name: "Teaching Aptitude",
                exam: "EMRS",
                reading: { target: 15, completed: 0 },
                revision: { target: 15, completed: 0 },
                practice: { target: 20, completed: 0 }
            },
            "ict": {
                name: "ICT",
                exam: "EMRS",
                reading: { target: 5, completed: 0 },
                revision: { target: 5, completed: 0 },
                practice: { target: 8, completed: 0 }
            },
            "reasoning": {
                name: "Reasoning",
                exam: "EMRS",
                reading: { target: 15, completed: 0 },
                revision: { target: 15, completed: 0 },
                practice: { target: 20, completed: 0 }
            },
            "nep": {
                name: "NEP",
                exam: "EMRS",
                reading: { target: 5, completed: 0 },
                revision: { target: 5, completed: 0 },
                practice: { target: 5, completed: 0 }
            },
            "case-study": {
                name: "Case Study",
                exam: "EMRS",
                reading: { target: 10, completed: 0 },
                revision: { target: 8, completed: 0 },
                practice: { target: 8, completed: 0 }
            },
            // KVS Subjects
            "maths": {
                name: "Mathematics",
                exam: "KVS",
                reading: { target: 15, completed: 0 },
                revision: { target: 15, completed: 0 },
                practice: { target: 20, completed: 0 }
            },
            "hindi": {
                name: "Hindi Language",
                exam: "KVS",
                reading: { target: 5, completed: 0 },
                revision: { target: 5, completed: 0 },
                practice: { target: 5, completed: 0 }
            },
            "english": {
                name: "English Language",
                exam: "KVS",
                reading: { target: 15, completed: 0 },
                revision: { target: 7, completed: 0 },
                practice: { target: 15, completed: 0 }
            },
            "gs": {
                name: "General Studies",
                exam: "KVS",
                reading: { target: 20, completed: 0 },
                revision: { target: 10, completed: 0 },
                practice: { target: 15, completed: 0 }
            }
        };

        // Timer functionality
        let timerInterval;
        let seconds = 0;
        let isRunning = false;
        let currentSubject = "";
        let currentMode = "";

        const timerDisplay = document.getElementById('timer');
        const startBtn = document.getElementById('start-btn');
        const pauseBtn = document.getElementById('pause-btn');
        const resetBtn = document.getElementById('reset-btn');
        const saveBtn = document.getElementById('save-btn');
        const subjectSelect = document.getElementById('subject-select');
        const sessionInfo = document.getElementById('session-info');
        const readingBtn = document.getElementById('reading-btn');
        const revisionBtn = document.getElementById('revision-btn');
        const practiceBtn = document.getElementById('practice-btn');

        function updateTimerDisplay() {
            const hrs = Math.floor(seconds / 3600);
            const mins = Math.floor((seconds % 3600) / 60);
            const secs = seconds % 60;
            
            timerDisplay.textContent = 
                `${hrs.toString().padStart(2, '0')}:${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }

        function setActiveMode(mode) {
            // Remove active class from all buttons
            readingBtn.classList.remove('active');
            revisionBtn.classList.remove('active');
            practiceBtn.classList.remove('active');
            
            // Add active class to selected button
            if (mode === 'reading') {
                readingBtn.classList.add('active');
                currentMode = 'reading';
            } else if (mode === 'revision') {
                revisionBtn.classList.add('active');
                currentMode = 'revision';
            } else if (mode === 'practice') {
                practiceBtn.classList.add('active');
                currentMode = 'practice';
            }
            
            updateSessionInfo();
        }

        function updateSessionInfo() {
            if (currentSubject && currentMode) {
                sessionInfo.innerHTML = `<i class="fas fa-info-circle"></i> <span>Studying: ${subjects[currentSubject].name} - ${currentMode.charAt(0).toUpperCase() + currentMode.slice(1)}</span>`;
            } else if (currentSubject) {
                sessionInfo.innerHTML = `<i class="fas fa-info-circle"></i> <span>Selected: ${subjects[currentSubject].name}. Please choose a study mode.</span>`;
            } else {
                sessionInfo.innerHTML = `<i class="fas fa-info-circle"></i> <span>Select a subject and study mode to begin</span>`;
            }
        }

        function startTimer() {
            if (subjectSelect.value === "") {
                alert("Please select a subject first!");
                return;
            }
            
            if (!currentMode) {
                alert("Please select a study mode (Reading, Revision, or Practice)!");
                return;
            }
            
            if (!isRunning) {
                isRunning = true;
                startBtn.disabled = true;
                pauseBtn.disabled = false;
                currentSubject = subjectSelect.value;
                
                timerInterval = setInterval(() => {
                    seconds++;
                    updateTimerDisplay();
                }, 1000);
                
                updateSessionInfo();
                
                // Prevent screen lock during study session
                if ('wakeLock' in navigator) {
                    navigator.wakeLock.request('screen').catch((err) => {
                        console.log(`Wake Lock error: ${err.name}, ${err.message}`);
                    });
                }
            }
        }

        function pauseTimer() {
            if (isRunning) {
                isRunning = false;
                startBtn.disabled = false;
                pauseBtn.disabled = true;
                clearInterval(timerInterval);
                updateSessionInfo();
            }
        }

        function resetTimer() {
            isRunning = false;
            startBtn.disabled = false;
            pauseBtn.disabled = true;
            clearInterval(timerInterval);
            seconds = 0;
            updateTimerDisplay();
            currentSubject = "";
            currentMode = "";
            setActiveMode("");
            updateSessionInfo();
        }

        function saveSession() {
            if (currentSubject && currentMode && seconds > 0) {
                const hoursStudied = seconds / 3600;
                subjects[currentSubject][currentMode].completed += hoursStudied;
                
                // Mobile-friendly notification
                if ('vibrate' in navigator) {
                    navigator.vibrate(200);
                }
                
                alert(`Session saved! You studied ${subjects[currentSubject].name} - ${currentMode} for ${hoursStudied.toFixed(2)} hours.`);
                resetTimer();
                renderSubjectCards();
            } else {
                alert("No active session to save. Please start a study session first.");
            }
        }

        // Event listeners with touch support
        startBtn.addEventListener('click', startTimer);
        startBtn.addEventListener('touchstart', function(e) {
            e.preventDefault();
            startTimer();
        });

        pauseBtn.addEventListener('click', pauseTimer);
        pauseBtn.addEventListener('touchstart', function(e) {
            e.preventDefault();
            pauseTimer();
        });

        resetBtn.addEventListener('click', resetTimer);
        resetBtn.addEventListener('touchstart', function(e) {
            e.preventDefault();
            resetTimer();
        });

        saveBtn.addEventListener('click', saveSession);
        saveBtn.addEventListener('touchstart', function(e) {
            e.preventDefault();
            saveSession();
        });

        readingBtn.addEventListener('click', () => setActiveMode('reading'));
        readingBtn.addEventListener('touchstart', function(e) {
            e.preventDefault();
            setActiveMode('reading');
        });

        revisionBtn.addEventListener('click', () => setActiveMode('revision'));
        revisionBtn.addEventListener('touchstart', function(e) {
            e.preventDefault();
            setActiveMode('revision');
        });

        practiceBtn.addEventListener('click', () => setActiveMode('practice'));
        practiceBtn.addEventListener('touchstart', function(e) {
            e.preventDefault();
            setActiveMode('practice');
        });

        subjectSelect.addEventListener('change', function() {
            currentSubject = this.value;
            updateSessionInfo();
        });

        // Countdown timers for exams
        function updateCountdowns() {
            const now = new Date().getTime();
            
            // EMRS Countdown
            const emrsDistance = emrsDate - now;
            if (emrsDistance > 0) {
                const emrsDays = Math.floor(emrsDistance / (1000 * 60 * 60 * 24));
                const emrsHours = Math.floor((emrsDistance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const emrsMinutes = Math.floor((emrsDistance % (1000 * 60 * 60)) / (1000 * 60));
                const emrsSeconds = Math.floor((emrsDistance % (1000 * 60)) / 1000);
                
                document.getElementById('emrs-days').textContent = `${emrsDays} days left`;
                document.getElementById('emrs-days-value').textContent = emrsDays;
                document.getElementById('emrs-hours-value').textContent = emrsHours;
                document.getElementById('emrs-minutes-value').textContent = emrsMinutes;
                document.getElementById('emrs-seconds-value').textContent = emrsSeconds;
            } else {
                document.getElementById('emrs-days').textContent = "Exam Completed!";
                document.getElementById('emrs-days-value').textContent = "0";
                document.getElementById('emrs-hours-value').textContent = "0";
                document.getElementById('emrs-minutes-value').textContent = "0";
                document.getElementById('emrs-seconds-value').textContent = "0";
            }
            
            // KVS Countdown
            const kvsDistance = kvsDate - now;
            if (kvsDistance > 0) {
                const kvsDays = Math.floor(kvsDistance / (1000 * 60 * 60 * 24));
                const kvsHours = Math.floor((kvsDistance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const kvsMinutes = Math.floor((kvsDistance % (1000 * 60 * 60)) / (1000 * 60));
                const kvsSeconds = Math.floor((kvsDistance % (1000 * 60)) / 1000);
                
                document.getElementById('kvs-days').textContent = `${kvsDays} days left`;
                document.getElementById('kvs-days-value').textContent = kvsDays;
                document.getElementById('kvs-hours-value').textContent = kvsHours;
                document.getElementById('kvs-minutes-value').textContent = kvsMinutes;
                document.getElementById('kvs-seconds-value').textContent = kvsSeconds;
            } else {
                document.getElementById('kvs-days').textContent = "Exam Completed!";
                document.getElementById('kvs-days-value').textContent = "0";
                document.getElementById('kvs-hours-value').textContent = "0";
                document.getElementById('kvs-minutes-value').textContent = "0";
                document.getElementById('kvs-seconds-value').textContent = "0";
            }
        }

        // Initialize countdowns
        updateCountdowns();
        setInterval(updateCountdowns, 1000);

        // Render subject cards
        function renderSubjectCards() {
            const container = document.getElementById('subjects-container');
            container.innerHTML = '';
            
            for (const [key, subject] of Object.entries(subjects)) {
                const totalTarget = subject.reading.target + subject.revision.target + subject.practice.target;
                const totalCompleted = subject.reading.completed + subject.revision.completed + subject.practice.completed;
                const progressPercent = Math.min((totalCompleted / totalTarget) * 100, 100);
                
                const readingPercent = Math.min((subject.reading.completed / subject.reading.target) * 100, 100);
                const revisionPercent = Math.min((subject.revision.completed / subject.revision.target) * 100, 100);
                const practicePercent = Math.min((subject.practice.completed / subject.practice.target) * 100, 100);
                
                const card = document.createElement('div');
                card.className = 'subject-card';
                card.innerHTML = `
                    <div class="subject-header">
                        <div class="subject-name">${subject.name}</div>
                        <div class="subject-hours">${totalCompleted.toFixed(1)}/${totalTarget} hrs</div>
                    </div>
                    <div class="subject-progress">
                        <div class="progress-labels">
                            <span>Overall Progress</span>
                            <span>${progressPercent.toFixed(1)}%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${progressPercent}%"></div>
                        </div>
                    </div>
                    <div class="mode-progress">
                        <div class="mode-progress-item reading">
                            <div>Reading</div>
                            <div>${subject.reading.completed.toFixed(1)}/${subject.reading.target}hrs</div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${readingPercent}%"></div>
                            </div>
                        </div>
                        <div class="mode-progress-item revision">
                            <div>Revision</div>
                            <div>${subject.revision.completed.toFixed(1)}/${subject.revision.target}hrs</div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${revisionPercent}%"></div>
                            </div>
                        </div>
                        <div class="mode-progress-item practice">
                            <div>Practice</div>
                            <div>${subject.practice.completed.toFixed(1)}/${subject.practice.target}hrs</div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${practicePercent}%"></div>
                            </div>
                        </div>
                    </div>
                `;
                
                container.appendChild(card);
            }
        }

        // Notification buttons functionality
        document.getElementById('test-reminder-btn').addEventListener('click', function() {
            alert('Daily test reminders enabled! You will receive notifications at 6:00 PM every day.');
            this.textContent = 'Enabled';
            this.disabled = true;
        });

        document.getElementById('study-reminder-btn').addEventListener('click', function() {
            alert('Study session reminders configured! You will receive reminders at your preferred study times.');
            this.textContent = 'Configured';
            this.disabled = true;
        });

        document.getElementById('countdown-alert-btn').addEventListener('click', function() {
            alert('Exam countdown alerts activated! You will receive weekly updates about your exam preparation.');
            this.textContent = 'Activated';
            this.disabled = true;
        });

        // Initialize the app
        renderSubjectCards();
        updateTimerDisplay();

        // Mobile-specific optimizations
        document.addEventListener('touchstart', function() {}, {passive: true});

        // Handle viewport height on mobile
        function setVH() {
            let vh = window.innerHeight * 0.01;
            document.documentElement.style.setProperty('--vh', `${vh}px`);
        }

        setVH();
        window.addEventListener('resize', setVH);
        window.addEventListener('orientationchange', setVH);

        // Simulate notification permission request
        setTimeout(() => {
            if (Notification.permission === 'default') {
                if (confirm('Would you like to receive daily study reminders?')) {
                    Notification.requestPermission();
                }
            }
        }, 3000);
    </script>
</body>
</html>
